# Code associated with Stochastic modeling of bovine tuberculosis dynamics in white-tailed deer

\textit{Mycobacterium bovis}, the causative agent of bovine tuberculosis (bTB), poses an economic risk to the United States (U.S.) cattle industry. Although management has reduced herd-level prevalence, repeated spillback from wildlife reservoirs, such as white-tailed deer (\textit{Odocoileus virginianus}), remains a major barrier to eradication. Here, we developed a stochastic simulation that incorporates seasonal changes in deer abundance (birth pulses and hunter harvest) and heterogeneity in contact behavior and immune responses to predict bTB dynamics in wildlife. We then used this framework to identify mechanisms that shape bTB outbreak trajectories and prevalence. Our results indicate that the probability of bTB endemicity depends more on the number of infected animals than herd size and that fadeout was unlikely unless the outbreak failed to take off in the first place. Additionally, we observed that rare, but high contact individuals are enough to sustain above average bTB prevalence. Finally, prevalence estimates using postmortem diagnostics on hunter-harvested animals provides a systematic underestimate of true prevalence, especially when disease prevalence is low. Our results suggest that preventive measures, such as fencing and covered water and feed storage, may be necessary to further decrease bTB prevalence in both species given the low probability of fadeout in wildlife. Further, although prevalence estimates from hunter harvest may be imperfect, relative changes between years could be used as a tool to identify outbreaks or evaluate intervention effectiveness.

# Usage

sim_pipeline.R can be used to run simulations and generate figures in the main text of the manuscript. The HPC directory contains batch files and code that can be run on a high-performance computing cluster.

`dens_figs.R` and `freq_figs.R` can be used to generate figures if data already exists in the data/ directory. If trying to generate figures for the frequency-dependent models, the frequency-dependent code must be compiled. It would be easiest to overwrite existing executables, like what is done in the shell (.sh) script in the hpc/ directory, so that no changes to the R code are necessary. Otherwise, the `system2()` command must be changed in the `bTBwl_fun.R` script.

## Contact
Please contact [Sam Smith](mailto:sm.smith@colostate.edu) with any questions.
